# ---------- Stage 1: Builder ----------
FROM golang:1.24-alpine AS builder

# Install git for fetching modules
RUN apk add --no-cache git

# Build Fabric binary (correct path to main package)
RUN go install github.com/danielmiessler/fabric/cmd/fabric@latest


# ---------- Stage 2: Runtime ----------
FROM alpine:3.20

# Copy Fabric binary from builder stage
COPY --from=builder /go/bin/fabric /usr/local/bin/fabric

# Default command
ENTRYPOINT ["fabric"]
CMD ["-h"]
